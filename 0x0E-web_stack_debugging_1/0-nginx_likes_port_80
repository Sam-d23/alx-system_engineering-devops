#!/bin/bash
#Checks and debugs why nginx is not listening 

# Step 1: Checks if Nginx is installed and running
if ! command -v nginx &> /dev/null; then
    echo "Nginx is not installed. Installing..."
    apt-get update
    apt-get install -y nginx
    systemctl start nginx
    systemctl enable nginx
else
    echo "Nginx is already installed."
fi

# Step 2: Checks Nginx configuration files for errors
echo "Checking Nginx configuration files..."
nginx -t

# Step 3: Verifies that there are no other services listening on port 80
echo "Checking for other services listening on port 80..."
netstat -tuln | grep LISTEN | grep ":80 "

# Step 4: Restarts Nginx to apply any changes
echo "Restarting Nginx..."
systemctl restart nginx

# Confirms whether Nginx is now listening on port 80
echo "Verifying Nginx is listening on port 80..."
netstat -tuln | grep LISTEN | grep ":80 "
