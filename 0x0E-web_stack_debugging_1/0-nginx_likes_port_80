#!/bin/bash
#Checks and debugs why nginx is not listening 

if ! command -v nginx &> /dev/null; then
    echo "Nginx is not installed. Installing..."
    apt-get update
    apt-get install -y nginx
fi

# Check if Nginx is running
if ! systemctl is-active --quiet nginx; then
    echo "Nginx is not running. Starting..."
    systemctl start nginx
fi

# Check if Nginx is configured to listen on port 80
nginx_config="/etc/nginx/sites-available/default"

# If the configuration file does not exist, create a basic one
if [ ! -e "$nginx_config" ]; then
    echo "Creating a basic Nginx configuration file..."
    cat <<EOL > "$nginx_config"
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name _;

    location / {
        root /var/www/html;
        index index.html;
    }
}
EOL
fi

# Ensure Nginx is enabled and restart
systemctl enable nginx
systemctl restart nginx

# Print status information
echo "Nginx is now configured to listen on port 80."
